<div class="frame" style="background-image: url(<%= rails_blob_url(@blog.image) if @blog.image.attached? %>)"></div>
<div class="over-frame-text">
  <h1><%= @blog.title %></h1>
  <div class="over-frame-bottom-row text-right">
    <h3>From <%= @blog.category %> Blogs</h3>
  </div> <!-- over-frame-text -->
</div> <!-- over-frame-text -->

<div class="row blog-show">
  <div class="container">
    <% if current_user && current_user.admin %>
      <div class="text-right">
        <%= link_to "Edit Blog", edit_blog_path(@blog) %>
      </div>
    <% end %>

    <div class="buffer"></div>

    <h3 class="text-center"><%= @blog.teaser %></h3>
    <p class="text-center">Published on <%= @blog.published_on.in_time_zone("America/Los_Angeles").strftime("%B %d, %Y") %></p>

    <%= render "layouts/hr" %>

    <%= @blog.body.html_safe %>

    <h2 class="text-center">About the Author</h2>
    <div class="half-buffer"></div>
    <%= render partial: "layouts/biobox", locals: { user: @blog.user } %>

    <% if current_user && current_user.admin %>
      <div class="text-center">
        <div class="half-buffer"></div>
        <%= link_to 'Edit', edit_blog_path(@blog) %> |
        <%= link_to 'Back', blogs_path %>
      </div>
    <% end %>

    <div class="new-comment">
      <%= simple_form_for [@blog, Comment.new] do |f| %>
        <%= f.error_notification %>

        <div class="form-inputs col-xs-12" style="margin-bottom: 10px">
          <%= f.label "Add a Comment" %>
          <%= f.text_area :body, class: "form-control" %>
        </div>

        <% if @user %>
          <%= f.hidden_field :name, value: [@user.first_name, @user.last_name].join(' ') %>
          <%= f.hidden_field :email, value: @user.email %>
        <% else %>
          <div class="form-inputs col-sm-6">
            <%= f.label "Your Name" %>
            <%= f.text_field :name, class: "form-control", required: true, placeholder: "e.g. Warren Buffett" %>
          </div>
          <div class="form-inputs col-sm-6">
            <%= f.label "Your Email (Not Displayed)" %>
            <%= f.text_field :email, class: "form-control", required: true, placeholder: "e.g. wbuffett@gmail.com" %>
          </div>
        <% end %>

        <div class="form-actions text-right">
          <%= f.button :submit, "Submit Comment", onclick: "ga('send',{'hitType': 'event','eventCategory': 'contribute', 'eventAction': 'Create Blog Comment'})" %>
        </div>
      <% end %>
    </div>

    <h2><%= pluralize(@comments.count, "Comment") %></h2>
    <div class="old-comment">
      <% @comments.each do |comment| %>
        <p style="margin-top: 10px"><strong><%= comment.body %></strong>
          <%= link_to blog_comment_path(@blog, comment), method: :delete, data: {confirm: "Are you sure you want to delete that comment?"} do %><span class="glyphicon glyphicon-remove"></span><% end %><br />
          <em>by <%= comment.name %> on <%= comment.created_at.to_formatted_s(:long) %></em></p>
      <% end %>
    </div>

  </div> <!-- page container -->
</div> <!-- row -->
