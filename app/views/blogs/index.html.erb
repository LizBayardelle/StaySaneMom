<!-- page-specific content -->
  <% title "Blog | SSM" %>
  <%= content_for :head do %>
    <meta name="description" content="We moms need all the help we can get. Find information about how to keep a clean house, a healthy marriage, balanced kids, and some sanity for mom." />
  <% end %>
<!-- page-specific content -->

<div class="header-frame frame text-center" style="background-image: url(<%= asset_path "best-parenting-blog.jpg" %>)"><div class="image-overlay image-overlay-white"><div class="inner-frame border-neutral"></div></div></div>
<div class="over-frame-text">
  <div class="container text-center">
    <h1>The Stay Sane Blog</h1>
    <h4>Get the latest tips delivered straight to your inbox.</h4>
    <script async data-uid="229e74784f" src="https://f.convertkit.com/229e74784f/ac0fba8d30.js"></script>
  </div> <!-- container -->
  <div class="over-frame-bottom-row text-center">
    <div class="container">
      <% if current_user && current_user.admin %>
        <div class="half-buffer"></div>
        <%= link_to 'New Blog', new_blog_path, class: "btn btn-outline-secondary" %>
        <div class="buffer"></div>
      <% end %>
    </div> <!-- over frame bottom row -->
  </div> <!-- over-frame-text -->
</div> <!-- over-frame-text -->


<div class="half-buffer"></div>


<% if current_user && current_user.admin %>
  <div class="bg-neutral"><div class="container">
    <% if @unpublished.count > 0 %>
      <div class="half-buffer"></div>
      <h2 class="font-script">Unpublished Blogs</h2>
      <% @unpublished.each do |blog| %>
        <h5><%= link_to blog.title, blog_path(blog) %></h5>
      <% end %>
      <div class="half-buffer"></div>
    <% end %>
  </div></div>
<% end %>

<div class="half-buffer"></div>

<!-- tag cloud -->
<div class="text-center full-width bg-neutral padded"><div id="tag_cloud">
  <h2 class="font-script">Looking for a specific topic?</h2>
  <% tag_cloud Blog.tag_counts, %w{s m l} do |tag, css_class| %>
  <%= link_to tag.name, tag_path(tag.name), class: css_class %>
  <% end %>
</div></div>
<!-- end tag cloud -->

<div class="buffer"></div>


<div class="container">
  <h2 class="font-script text-center">Most Popular Blogs</h2>

  <div class="row small-boxes">
  <% @commented_blogs.each do |blog| %>
    <%= link_to blog do %>
      <div class="blog-card col-lg-4">
        <% case blog.category %>
        <% when "House" %>
          <div class="house transparent-hover contents">
            <div class="flag">House</div>
        <% when "Spouse" %>
          <div class="spouse transparent-hover contents">
            <div class="flag">Spouse</div>
        <% when "Kids" %>
          <div class="kids transparent-hover contents">
            <div class="flag">Kids</div>
        <% when "Self" %>
          <div class="self transparent-hover contents">
            <div class="flag">Self</div>
        <% else %>
          <div class="other transparent-hover contents neutral">
            <div class="flag">General</div>
        <% end %>
            <div class="small-blog-frame" style="background-image: url(<%= rails_blob_url(blog.image) if blog.image.attached? %>)">
              <% case blog.category %>
              <% when "House" %>
                <div class="image-overlay-house"></div>
              <% when "Spouse" %>
                <div class="image-overlay-spouse"></div>
              <% when "Kids" %>
                <div class="image-overlay-kids"></div>
              <% when "Self" %>
                <div class="image-overlay-self"></div>
              <% else %>
                <div class="image-overlay-neutral"></div>
              <% end %>
            </div>
            <div class="blog-text">
                <h5><%= blog.title %></h5>
                <p class="published-on">
                  <small>
                  <%= pluralize(blog.comments.count, "Comment") %> (<%= blog.published_on.in_time_zone("America/Los_Angeles").strftime("%D") %>)
                  <% if current_user && current_user.admin %>
                      <%= link_to edit_blog_path(blog) do %><%= fa_icon "pencil" %><% end %>
                      <%= link_to blog, method: :delete, data: { confirm: 'Are you sure?' } do %><%= fa_icon "remove" %><% end %>
                  <% else %>
                       | <%= link_to "Home", root_path %>
                  <% end %>
                </small></p>
            </div> <!-- blog-text -->
          </div> <!-- end case div -->
      </div> <!-- blog card/col -->
    <% end %>
  <% end %>
</div> <!-- row -->




  <div class="buffer"></div>


  <h2 class="font-script text-center">Newest Blogs</h2>
  <div class="row">

    <% @blogs.each do |blog| %>
      <%= link_to blog do %>
        <div class="col-lg-6 col-xl-4"><div class="blog-card">
          <% case blog.category %>
          <% when "House" %>
            <div class="house transparent-hover">
              <div class="flag">House</div>
          <% when "Spouse" %>
            <div class="spouse transparent-hover">
              <div class="flag">Spouse</div>
          <% when "Kids" %>
            <div class="kids transparent-hover">
              <div class="flag">Kids</div>
          <% when "Self" %>
            <div class="self transparent-hover">
              <div class="flag">Self</div>
          <% else %>
            <div class="other transparent-hover neutral">
              <div class="flag">General</div>
          <% end %>
              <div class="blog-frame" style="background-image: url(<%= rails_blob_url(blog.image) if blog.image.attached? %>)">
                <% case blog.category %>
                <% when "House" %>
                  <div class="image-overlay-house"></div>
                <% when "Spouse" %>
                  <div class="image-overlay-spouse"></div>
                <% when "Kids" %>
                  <div class="image-overlay-kids"></div>
                <% when "Self" %>
                  <div class="image-overlay-self"></div>
                <% else %>
                  <div class="image-overlay-neutral"></div>
                <% end %>
              </div>
              <div class="blog-text">
                <div class="blog-description">
                  <h2><%= blog.title %></h2>
                  <p class="blog-teaser"><%= blog.teaser %><span class="color-neutral" style="padding-left: 5px"><%= blog.cta_read_more + "..." %></span></p>
                </div> <!-- blog description -->
                <div class="blog-info">
                  <p class="published-on">
                    <small>
                    <%= pluralize(blog.comments.count, "Comment") %>, Published on <%= blog.published_on.in_time_zone("America/Los_Angeles").strftime("%B %d, %Y") %>
                    <% if current_user && current_user.admin %>
                        <%= link_to edit_blog_path(blog) do %> <%= fa_icon "pencil" %><% end %>
                        <%= link_to blog, method: :delete, data: { confirm: 'Are you sure?' } do %> <%= fa_icon "remove" %><% end %>
                    <% else %>
                         | <%= link_to "Home", root_path %>
                    <% end %>
                  </small></p>
                </div> <!-- blog info -->
              </div> <!-- blog-text -->
            </div> <!-- end case div -->
        </div></div> <!-- blog card/col -->
      <% end %>
    <% end %>
  </div> <!-- row -->

  <div class="text-center">
    <% { is_active: true } %>
    <h5 class="text-center pagination"><%= will_paginate @blogs %></h5>
  </div>

</div> <!-- page container -->

<script>
  $(document).ready(function() {
    $('.blog-text').matchHeight();
    $('.blog-teaser').matchHeight();
    $('.blog-description').matchHeight();
    $('.blog-info').matchHeight();
    $('.formkit-submit').click(function() {
        ga('send', 'subscribe', 'convertkitClick', 'click', 'BlogIndexCTA');
    });
  });
</script>
