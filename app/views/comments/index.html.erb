<!-- page-specific content -->
  <% title "Comment List | SSM" %>
<!-- page-specific content -->


<div class="container">
  <h1 class="text-center">Comments</h1>
  <h5 class="text-center"><%= pluralize(@comments.count, "Total Comment") %></h5>
      <% @comments.each do |comment| %>
        <% @comment = comment %>
        <p><%= comment.body %>
          <br /><em><%= comment.name %> (<%= mail_to comment.email %>)</em>
          <br /><strong><% if comment.blog_id %><%= Blog.where(id: comment.blog_id).first.title %> (<%= Blog.where(id: comment.blog_id).first.comments.count %>)<% end %></strong>
          <a href="#editPopup<%= @comment.id %>" class="open-popup-link"><%= fa_icon "pencil" %></a>
          <%= link_to comment_path(comment), method: :delete, data: { confirm: 'Are you sure?' } do %><%= fa_icon "remove" %><% end %>
        </p>

        <!-- form itself -->
        <div id="editPopup<%= @comment.id %>" class="white-popup mfp-hide">
          <h2>Edit Comment</h2>
          <%= simple_form_for(@comment) do |f| %>
          <div class="field">
            <div class="control">
              <%= f.input :name, input_html: { class: 'input' }, wrapper: false, label_html: { class: 'label' } %>
            </div>
          </div>

          <div class="field">
            <div class="control">
              <%= f.input :body, input_html: { class: 'textarea' }, wrapper: false, label_html: { class: 'label' }  %>
            </div>
          </div>
          <div class="half-buffer"></div>
          <div class="text-center"><%= f.button :submit, 'Update Comment', class: "btn btn-outline-danger" %></div>
          <% end %>

        </div>
      <% end %>
</div> <!-- page container -->


<!-- form itself -->
<div id="editPopup<%= @comment.id %>" class="white-popup mfp-hide">
  <h2>Edit Comment</h2>
  <%= simple_form_for(@comment) do |f| %>
  <div class="field">
    <div class="control">
      <%= f.input :name, input_html: { class: 'input' }, wrapper: false, label_html: { class: 'label' } %>
    </div>
  </div>

  <div class="field">
    <div class="control">
      <%= f.input :body, input_html: { class: 'textarea' }, wrapper: false, label_html: { class: 'label' }  %>
    </div>
  </div>
  <%= f.button :submit, 'Update Comment', class: "btn btn-outline-danger" %>
  <% end %>

</div>

<script>
  $('.open-popup-link').magnificPopup({
    type:'inline',
    midClick: true // Allow opening popup on middle mouse click. Always set it to true if you don't provide alternative source in href.
  });
</script>
