<div class="header-frame frame" style="background-image: url(<%= asset_path "tools-for-homepage.jpg" %>)"><div class="image-overlay-white"><div class="inner-frame border-neutral"></div></div></div>
<div class="over-frame-text">
  <div class="container text-center">
    <% if @user.first_name %>
      <h1><%= @user.first_name %>'s Homepage</h1>
    <% else %>
      <h1>My Homepage</h1>
    <% end %>
    <h4><strong>Here's where you find all your personalized tools and goodies.</strong></h4>
    <% if @user.contributor && @user == current_user %>
      <h4><strong>(And all your contributor superpowers.)</strong></h4>
    <% end %>
    <div class="half-buffer"></div>
    <h3><%= link_to 'Edit My Info', edit_user_registration_path %>  |  <%= link_to('Logout', destroy_user_session_path, :method => :delete) %></h3>
  </div> <!-- container -->
</div> <!-- over-frame-text -->

<% if current_user.admin && current_user == @user %>
  <div class="half-buffer"></div>
  <%= render "layouts/quadborder" %>
  <div class="half-buffer"></div>

  <div class="container"> <!-- admin stuff -->
		<h2 class="text-center font-script">Admin Stuff</h2>

		<div class="half-buffer"></div>

    <div class="row">
      <div class="col-sm-6 col-lg-4">
        <%= link_to users_path do %>
          <div id="subscribers" class="card padded">
            <h3 class="text-center">Subscribers</h3>
            <p>Total Subscribers: <%= @subscribers['total_subscribers'] %></p>
          </div>
        <% end %>
      </div>

  		<div class="col-sm-6 col-lg-4">
        <%= link_to users_path do %>
    			<div id="members" class="card padded">
    				<h3 class="text-center">Members</h3>
    				<p>Member Count: <%= @members.count - 1 %>
              <br />New Members (This Week): <%= @new_members.count %></p>
    			</div>
    		<% end %>
      </div>

      <div class="col-sm-6 col-lg-4">
        <%= link_to contributions_path do %>
          <div id="members" class="card padded">
            <h3 class="text-center">Guest Posts</h3>
            <p>
              Unread Guest Post Ideas: <%= @contributions.count %><br />
              Contributor Requests: <%= User.where(contributor: false, contributor_request: true).count %><br />
              Posts Awaiting Approval: <%= Blog.where(submitted: true, approved: false).count %>
            </p>
          </div>
        <% end %>
      </div>

      <div class="col-sm-6 col-lg-4">
        <%= link_to comments_path do %>
          <div id="members" class="card padded">
            <h3 class="text-center">Comments</h3>
            <p>Total Comments: <%= @comments.count %>
              <br />New Comments (This Week): <%= @new_comments.count %></p>
          </div>
        <% end %>
      </div>
    </div> <!-- row -->

  </div> <!-- container -->
<% end %>


<% if @user == current_user && @user.contributor %>
  <div class="half-buffer"></div>
  <%= render "layouts/quadborder" %>
  <div class="half-buffer"></div>

  <div class="container">
    <h2 class="text-center font-script">My Contributor Area</h2>
    <div class="text-center">
      <%= link_to "Start a New Blog Post", new_blog_path, class: "btn btn-outline-danger" %>
    </div> <!-- text center -->
    <div class="half-buffer"></div>
    <div class="row">
      <div class="col-lg-6">
        <h3>My WIP Posts</h3>
          <% @wip_posts = @user.blogs.where(published: false, submitted: false, approved: false) %>
          <% if @wip_posts != [] %>
            <ul>
              <% @wip_posts.each do |blog| %>
                <li><%= link_to blog.title, blog_path(blog) %></li>
              <% end %>
            </ul>
          <% else %>
            <p>You currently don't have any WIP posts.</p>
          <% end %>
      </div> <!-- col -->

      <div class="col-lg-6">
        <h3>My Submitted Posts</h3>
          <% @submitted_posts = @user.blogs.where(published: false, submitted: true, approved: false) %>
          <% if @submitted_posts != [] %>
            <ul>
              <% @submitted_posts.each do |blog| %>
                <li><%= link_to blog.title, blog_path(blog) %></li>
              <% end %>
            </ul>
          <% else %>
            <p>You currently don't have any submitted posts.</p>
          <% end %>
      </div> <!-- col -->

      <div class="col-lg-6">
        <h3>My Approved Posts</h3>
        <% @approved_posts = @user.blogs.where(published: false, submitted: true, approved: true) %>
        <% if @approved_posts != [] %>
          <ul>
            <% @approved_posts.each do |blog| %>
              <li><%= link_to blog.title, blog_path(blog) %></li>
            <% end %>
          </ul>
        <% else %>
          <p>You currently don't have any published posts.</p>
        <% end %>
      </div> <!-- col -->

      <div class="col-lg-6">
        <h3>My Published Posts</h3>
        <% @published_posts = @user.blogs.where(published: true) %>
        <% if @published_posts != [] %>
          <ul>
            <% @published_posts.each do |blog| %>
              <li><%= link_to blog.title, blog_path(blog) %></li>
            <% end %>
          </ul>
        <% else %>
          <p>You currently don't have any published posts.</p>
        <% end %>
      </div> <!-- col -->

    </div> <!-- row -->
  </div> <!-- container -->
<% end %>


<div class="half-buffer"></div>
<%= render "layouts/quadborder" %>
<div class="half-buffer"></div>



<div class="container">
  <% if @user == current_user %>
  <h2 class="text-center font-script">My Tools</h2>

  <div class="row">

    <div class="col-md-6 col-lg-4"><div class="tool-box content-box border-neutral transparent-hover neutral">
      <%= link_to tasks_path do %>
        <div class="content-box-img" style="background-image: url(<%= asset_path "to-do-list.jpg" %>)"><div class="image-overlay-neutral"></div></div>
        <div class="text">
          <h2 class="text-center">My To Do<br />List</h2>
          <p>
            <strong>One Time Tasks:</strong> <%= if @done_onetime_tasks != nil then @done_onetime_tasks.count else 0 end %> of <%= if @onetime_tasks != nil then @onetime_tasks.count else 0 end %> Done<br />
            <strong>Daily Tasks:</strong> <%= if @done_daily_tasks != nil then @done_daily_tasks.count else 0 end %> of <%= if @daily_tasks != nil then @daily_tasks.count else 0 end %> Done<br />
            <strong>Weekly Tasks:</strong> <%= if @done_weekly_tasks != nil then @done_weekly_tasks.count else 0 end %> of <%= if @weekly_tasks != nil then @weekly_tasks.count else 0 end %> Done<br />
            <strong>Monthly Tasks:</strong> <%= if @done_monthly_tasks != nil then @done_monthly_tasks.count else 0 end %> of <%= if @monthly_tasks != nil then @monthly_tasks.count else 0 end %> Done<br />
          </p>
        </div> <!-- text -->
        <h5 class="text-center"><%= link_to "Go to My List", tasks_path, class: "color-spouse" %></h5>
      <% end %>
    </div></div> <!-- category div / col div -->


		<div class="col-md-6 col-lg-4"><div class="tool-box content-box border-neutral transparent-hover neutral">
			<%= link_to people_path do %>
				<div class="content-box-img" style="background-image: url(<%= asset_path "keep-track-of-family-dates-and-events.jpg" %>)"><div class="image-overlay-neutral"></div></div>
				<div class="text">
					<h2 class="text-center">Upcoming Birthdays</h2>
          <% if !@people_birthday.empty? %>
  					<p>
              <% @people_birthday.each do |p| %>
                <%= p.birthday.strftime("%b %e") %>: <%= p.first_name %> <%= p.last_name %><br />
              <% end %>
            </p>
          <% else %>
            <p class="text-center">Tracking birthdays in one place will help make sure you never accidentally forget someone's special day.</p>
          <% end %>
				</div> <!-- text -->
        <% if !@people_birthday.empty? %>
          <h5 class="text-center"><%= link_to "See All Birthdays", tasks_path, class: "color-spouse" %></h5>
        <% else %>
          <h5 class="text-center"><%= link_to "Start Tracking Now", tasks_path, class: "color-spouse" %></h5>
        <% end %>
			<% end %>
		</div></div> <!-- category div / col div -->

		<div class="col-md-6 col-lg-4"><div class="tool-box content-box border-neutral transparent-hover neutral">
			<%= link_to occasions_path do %>
				<div class="content-box-img" style="background-image: url(<%= asset_path "gift-planner.jpg" %>)"><div class="image-overlay-neutral"></div></div>
				<div class="text">
					<h2 class="text-center">Gift<br />Planner</h2>
					<p>
            <strong><%= if @occasions then @occasions.count else 0 end %></strong> <%= "Upcoming Occasion".pluralize(@occasions.count) %><br />
            <strong><%= if @gifts then @gifts.count else 0 end %></strong> <%= "Gift".pluralize(@gifts.count) %> to Buy
          </p>
				</div> <!-- text -->
        <% if @occasions.empty? && @gifts.empty? %>
          <h5 class="text-center"><%= link_to "Start Planning Now", tasks_path, class: "color-spouse" %></h5>
        <% else %>
          <h5 class="text-center"><%= link_to "All My Gifts", tasks_path, class: "color-spouse" %></h5>
        <% end %>
			<% end %>
		</div></div> <!-- category div / col div -->

  <% end %>
	</div> <!-- row -->
</div> <!-- container -->

	<div class="half-buffer"></div>

  <% if current_user.bio %>
	 <%= render partial: "layouts/biobox", locals: { user: current_user, header: nil } %>
   <div class="buffer"></div>
  <% elsif current_user == @user %>
    <div class="half-buffer"></div>
    <h2 class="text-center color-spouse">- - <%= link_to 'Complete My Profile', edit_user_registration_path, class: "color-spouse" %> - -</h2>
  <% end %>




<script>
  $(function() {
    $('.content-box').matchHeight();
    $('.text').matchHeight();
  	$('.card').matchHeight();
  });
</script>
